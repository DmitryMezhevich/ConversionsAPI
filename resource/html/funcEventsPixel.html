<!--
    Функции для отправки событий в Pixel, как напрямую, так и через Events API
-->

<script>
    function sendEventToFB(name = null, phone = null) {
        const eventName = phone ? 'Purchase' : 'PageView';
        const customData =
            eventName === 'Purchase' ? { value: 0.0, currency: 'USD' } : {};

        fbq('track', `${eventName}`, customData, {
            eventID: eventID,
        });

        const eventModule = {
            fbPixelID: fbPixelID,
            eventName: eventName,
            eventSourceUrl: window.location.href,
            eventID: eventID,
            fbc: getCookie('_fbc'),
            fbp: getCookie('_fbp'),
            name: name,
            phone: phone,
            testEventCode: testEventCodeFB,
        };

        sendEvent(
            `https://api-planetshop.online/eventManager/fb/event`,
            eventModule
        );
    }

    function sendEventToTT(phone = null) {
        const eventName = phone ? 'SubmitForm' : 'Pageview';
        const identify = {external_id: eventID};
        const _phone = formatPhoneNumber(phone);
        if (_phone) {
            identify.phone_number = _phone;
        }

        ttq.identify(identify)        
        ttq.track(eventName, {}, {event_id: eventID});

        const eventModule = {
            ttPixelID: ttPixelID,
            eventName: eventName,
            eventSourceUrl: window.location.href,
            eventID: eventID,
            ttclid: getCookie('ttclid'),
            ttp: getCookie('_ttp'),
            phone: _phone,
            testEventCode: testEventCodeTT,
        };

        sendEvent(
            `https://api-planetshop.online/eventManager/tt/event`,
            eventModule
        );
    }

    
</script>